<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="Infinity Merge Tower v3.0 - 5클래스 생존 게임">
    <meta name="theme-color" content="#1a1a2e">
    <title>Infinity Merge Tower v3.0</title>
    <link rel="stylesheet" href="src/css/main.css">
</head>
<body>
    <!-- 로딩 화면 -->
    <div id="loading-screen">
        <div class="loading-title">Infinity Merge Tower</div>
        <div class="loading-subtitle">5 Heroes, Infinite Battle</div>
        <div class="loading-bar">
            <div class="loading-progress"></div>
        </div>
    </div>

    <div id="game-container">
        <!-- 상단 자원 바 -->
        <div id="top-bar">
            <button class="menu-toggle-btn" id="menu-toggle" onclick="toggleSideMenu()">
                <span class="hamburger-icon">☰</span>
            </button>
            <div class="resource">
                <div class="resource-icon gold-icon">💰</div>
                <span id="gold-amount">100</span>
            </div>
            <div class="stage-display">
                <span class="stage-label">Stage</span>
                <span id="current-stage" class="stage-value">1</span>
            </div>
            <div class="resource">
                <div class="resource-icon gem-icon">💎</div>
                <span id="gem-amount">0</span>
            </div>
        </div>

        <!-- 사이드 메뉴 오버레이 -->
        <div class="side-menu-overlay" id="side-menu-overlay" onclick="toggleSideMenu()"></div>

        <!-- 사이드 메뉴 -->
        <div class="side-menu" id="side-menu">
            <div class="side-menu-header">
                <span>메뉴</span>
                <button class="side-menu-close" onclick="toggleSideMenu()">×</button>
            </div>
            <div class="side-menu-content">
                <button class="side-menu-item" id="daily-btn">
                    <span class="side-menu-icon">🎁</span>
                    <span class="side-menu-text">일일 출석</span>
                    <span class="side-menu-badge" id="daily-badge"></span>
                </button>
                <button class="side-menu-item" id="quest-btn">
                    <span class="side-menu-icon">📋</span>
                    <span class="side-menu-text">퀘스트</span>
                    <span class="side-menu-badge" id="quest-badge"></span>
                </button>
                <button class="side-menu-item" id="lootbox-btn">
                    <span class="side-menu-icon">📦</span>
                    <span class="side-menu-text">보물 상자</span>
                    <span class="side-menu-badge" id="lootbox-badge"></span>
                </button>
                <button class="side-menu-item" id="challenge-btn">
                    <span class="side-menu-icon">🗼</span>
                    <span class="side-menu-text">도전 모드</span>
                </button>
                <button class="side-menu-item" id="codex-btn">
                    <span class="side-menu-icon">📖</span>
                    <span class="side-menu-text">몬스터 도감</span>
                </button>
                <button class="side-menu-item" id="achievement-btn">
                    <span class="side-menu-icon">🏆</span>
                    <span class="side-menu-text">업적</span>
                </button>
                <div class="side-menu-divider"></div>
                <button class="side-menu-item" id="settings-btn">
                    <span class="side-menu-icon">⚙️</span>
                    <span class="side-menu-text">설정</span>
                </button>
            </div>
        </div>

        <!-- 컨트롤 바 (배속 & 자동 머지) -->
        <div id="control-bar">
            <button class="control-btn speed-btn active" data-speed="1">1x</button>
            <button class="control-btn speed-btn" data-speed="2">2x</button>
            <button class="control-btn speed-btn" data-speed="3">3x</button>
            <span class="spacer"></span>
            <button class="control-btn" id="auto-merge-btn">🔄 자동 머지</button>
        </div>

        <!-- 전투 영역 -->
        <div id="battle-area">
            <canvas id="battle-canvas"></canvas>

            <!-- 웨이브 진행바 -->
            <div id="wave-progress">
                <div id="wave-progress-bar"></div>
                <div id="wave-text">Wave 1 - 0/10</div>
            </div>

            <!-- DPS 표시 -->
            <div id="dps-display">DPS: 0</div>

            <!-- 최고 스테이지 -->
            <div id="best-stage">Best: Stage 1</div>

            <!-- 보스 타이머 -->
            <div id="boss-timer">⏱️ <span id="boss-time-left">60</span>초</div>

            <!-- 스킬 버튼 (전투 영역 내) -->
            <div id="skill-buttons">
                <!-- JavaScript에서 생성 -->
            </div>

            <!-- 히어로 스탯 패널 -->
            <div id="hero-stats-panel">
                <div class="hero-stats-title">선택된 히어로</div>
                <div id="selected-hero-stats"></div>
            </div>
        </div>

        <!-- 히어로 탭 & 머지 영역 -->
        <div id="hero-section">
            <!-- 히어로 클래스 탭 -->
            <div id="hero-tabs">
                <!-- JavaScript에서 생성 -->
            </div>

            <!-- 머지 그리드 (3x3) -->
            <div id="merge-grid">
                <!-- 9개 슬롯 - JavaScript에서 생성 -->
            </div>

            <!-- 메인 액션 버튼 -->
            <div id="bottom-bar">
                <button class="action-btn" id="summon-btn">
                    🎲 소환
                    <span class="btn-cost" id="summon-cost">💰 10</span>
                </button>
                <button class="action-btn" id="upgrade-btn">
                    ⬆️ 강화
                </button>
                <button class="action-btn" id="shop-btn">
                    🏪 상점
                </button>
            </div>
        </div>
    </div>

    <!-- 상점 모달 -->
    <div class="modal" id="shop-modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">🏪 상점</span>
                <button class="close-btn" onclick="closeModal('shop-modal')">×</button>
            </div>
            <div id="shop-items">
                <div class="shop-item">
                    <div class="shop-item-info">
                        <div class="shop-item-name">💰 골드 팩</div>
                        <div class="shop-item-desc">+1000 골드</div>
                    </div>
                    <button class="shop-buy-btn" onclick="buyGoldPack()">💎 10</button>
                </div>
                <div class="shop-item">
                    <div class="shop-item-info">
                        <div class="shop-item-name">🎲 럭키 소환권</div>
                        <div class="shop-item-desc">무료 소환 5회</div>
                    </div>
                    <button class="shop-buy-btn" onclick="buyLuckySummon()">💎 20</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 업그레이드 모달 -->
    <div class="modal" id="upgrade-modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">⬆️ 영구 강화</span>
                <button class="close-btn" onclick="closeModal('upgrade-modal')">×</button>
            </div>
            <div id="upgrade-items">
                <!-- JavaScript에서 렌더링 -->
            </div>
        </div>
    </div>

    <!-- 업적 모달 -->
    <div class="modal" id="achievement-modal">
        <div class="modal-content wide">
            <div class="modal-header">
                <span class="modal-title">🏆 업적</span>
                <button class="close-btn" onclick="closeModal('achievement-modal')">×</button>
            </div>
            <div id="achievement-items">
                <!-- JavaScript에서 렌더링 -->
            </div>
        </div>
    </div>

    <!-- 설정 모달 -->
    <div class="modal" id="settings-modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">⚙️ 설정</span>
                <button class="close-btn" onclick="closeModal('settings-modal')">×</button>
            </div>
            <div class="settings-content">
                <div class="shop-item">
                    <div class="shop-item-info">
                        <div class="shop-item-name">🔊 사운드</div>
                        <div class="shop-item-desc">효과음 ON/OFF</div>
                    </div>
                    <button class="shop-buy-btn" id="sound-toggle-btn" onclick="toggleSound()">ON</button>
                </div>
                <div class="shop-item">
                    <div class="shop-item-info">
                        <div class="shop-item-name">💾 데이터 저장</div>
                        <div class="shop-item-desc">수동으로 저장</div>
                    </div>
                    <button class="shop-buy-btn" onclick="manualSave()">저장</button>
                </div>
                <div class="shop-item danger">
                    <div class="shop-item-info">
                        <div class="shop-item-name">⚠️ 데이터 초기화</div>
                        <div class="shop-item-desc">모든 진행 삭제</div>
                    </div>
                    <button class="shop-buy-btn danger" onclick="confirmReset()">초기화</button>
                </div>
            </div>
            <div class="version-info">
                Infinity Merge Tower v3.0<br>
                5 Heroes System
            </div>
        </div>
    </div>

    <!-- 일일 보상 모달 -->
    <div class="modal" id="daily-modal">
        <div class="modal-content wide">
            <div class="modal-header">
                <span class="modal-title">🎁 일일 출석 보상</span>
                <button class="close-btn" onclick="closeModal('daily-modal')">×</button>
            </div>
            <div id="daily-reward-items">
                <!-- JavaScript에서 렌더링 -->
            </div>
        </div>
    </div>

    <!-- 퀘스트 모달 -->
    <div class="modal" id="quest-modal">
        <div class="modal-content wide">
            <div class="modal-header">
                <span class="modal-title">📋 퀘스트</span>
                <button class="close-btn" onclick="closeModal('quest-modal')">×</button>
            </div>
            <div id="quest-items">
                <!-- JavaScript에서 렌더링 -->
            </div>
        </div>
    </div>

    <!-- 상자 모달 -->
    <div class="modal" id="lootbox-modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">📦 보물 상자</span>
                <button class="close-btn" onclick="closeModal('lootbox-modal')">×</button>
            </div>
            <div id="lootbox-items">
                <!-- JavaScript에서 렌더링 -->
            </div>
        </div>
    </div>

    <!-- 도전 모드 모달 -->
    <div class="modal" id="challenge-modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">🗼 도전 모드</span>
                <button class="close-btn" onclick="closeModal('challenge-modal')">×</button>
            </div>
            <div id="challenge-items">
                <!-- JavaScript에서 렌더링 -->
            </div>
        </div>
    </div>

    <!-- 도감 모달 -->
    <div class="modal" id="codex-modal">
        <div class="modal-content wide">
            <div class="modal-header">
                <span class="modal-title">📖 몬스터 도감</span>
                <button class="close-btn" onclick="closeModal('codex-modal')">×</button>
            </div>
            <div id="codex-items">
                <!-- JavaScript에서 렌더링 -->
            </div>
        </div>
    </div>

    <!-- JavaScript 모듈 로드 (순서 중요) -->
    <script src="src/js/config.js"></script>
    <script src="src/js/state.js"></script>
    <script src="src/js/audio.js"></script>
    <script src="src/js/storage.js"></script>
    <script src="src/js/features.js"></script>
    <script src="src/js/ui.js"></script>
    <script src="src/js/combat.js"></script>
    <script src="src/js/game.js"></script>
</body>
</html>
